# Prometheus Interview Guide

## Core Concepts

**Metrics**: Measurements or data points that indicate what is happening in a system (e.g., CPU usage, request count, memory consumption).

**Monitoring**: The continuous process of observing metrics over time to establish baselines, detect anomalies, and identify issues.

**Prometheus**: An open-source monitoring and alerting toolkit with a powerful query language (PromQL), designed for reliability and scalability in dynamic environments.

## Architecture Components

**Prometheus Server**: Core component that scrapes metrics, stores them in a time-series database (TSDB), and serves queries via HTTP API.

**Service Discovery**: Automatically identifies scrape targets in dynamic environments (Kubernetes, Consul, File-based configurations).

**Pushgateway**: Allows short-lived jobs to push metrics to Prometheus for later scraping.

**Alertmanager**: Handles alert deduplication, grouping, routing, and delivery to notification channels (Slack, email, PagerDuty).

**Exporters**: Bridge applications that expose metrics from third-party systems in Prometheus format (Node Exporter, MySQL Exporter, etc.).

**PromQL**: Prometheus Query Language for querying and aggregating time-series data.

**Grafana**: Visualization platform that integrates with Prometheus for creating dashboards and graphs.

**Components**:

- **Retrieval**: Scrapes metrics from endpoints using static configs or dynamic service discovery
- **TSDB (Time Series Database)**: Efficiently stores high volumes of time-series data
- **HTTP Server**: Provides API for PromQL queries and metadata retrieval
- **Storage**: Local disk storage (HDD/SSD) optimized for time-series data

### Service Discovery

**Automatically identifies and manages scrape targets** in dynamic environments where services are constantly created and destroyed.

**Types**:

- **Kubernetes**: Discovers services, pods, and nodes using Kubernetes API
- **File SD**: Reads static target configurations from files for flexibility

### Pushgateway

**Exposes metrics from short-lived jobs** that cannot be scraped directly by Prometheus. Jobs push metrics to Pushgateway, which Prometheus then scrapes.

**Use Case**: Batch jobs or tasks with limited lifespan that would otherwise miss metric collection.

### Alertmanager

**Manages alerts generated by Prometheus** by deduplicating, grouping, and routing them to appropriate notification channels (PagerDuty, email, Slack).

### Exporters

**Small applications that collect metrics** from third-party systems and expose them in Prometheus format.

**Common Types**:

- **Node Exporter**: Hardware and OS metrics
- **MySQL Exporter**: Database metrics
- **Redis Exporter**: Redis metrics
- **Blackbox Exporter**: Probing endpoints (HTTP, DNS, TCP, ICMP)

### Prometheus Web UI

**Built-in interface** for exploring metrics, running ad-hoc PromQL queries, and visualizing results directly in Prometheus.

### Grafana

**Powerful dashboard and visualization tool** that integrates with Prometheus to provide rich, customizable visualizations of metrics data.

### API Clients

**HTTP API interfaces** that allow external systems to fetch data, query metrics, and integrate Prometheus with custom applications.
## Key Features

- **Pull-based model**: Prometheus scrapes metrics from targets at regular intervals
- **Multi-dimensional data model**: Uses labels for flexible querying and aggregation
- **Local storage**: Efficient time-series database optimized for append-only writes
- **Service discovery**: Automatic target detection in cloud-native environments
- **Alerting**: Built-in alert evaluation and integration with Alertmanager
- **PromQL**: Powerful query language for data analysis and aggregation

## Common Interview Questions

## Common Interview Questions

**Q: What is Prometheus and why use it?**
A: Prometheus is an open-source monitoring toolkit with powerful querying (PromQL), service discovery, and excellent Kubernetes integration. It excels in cloud-native environments with dynamic infrastructure.

**Q: Explain the pull vs push model in monitoring.**
A: Prometheus uses pull-based scraping where it fetches metrics from targets at intervals. Push-based systems require applications to send metrics to collectors. Pull is more reliable as Prometheus controls the scraping schedule and can detect when targets are down.

**Q: When would you use Pushgateway?**
A: For short-lived batch jobs that complete before Prometheus can scrape them, or for applications behind firewalls where direct pull isn't feasible. However, it should be used sparingly as it bypasses Prometheus's pull model benefits.

**Q: How does service discovery work in Prometheus?**
A: Service discovery automatically detects scrape targets. In Kubernetes, it uses the K8s API to discover pods, services, and nodes. It can also use file-based, Consul, EC2, or other discovery mechanisms.

**Q: What is PromQL?**
A: Prometheus Query Language - a functional language for querying time-series data. It supports aggregations, functions, and operations for analyzing metrics.

**Q: How does Prometheus handle high availability?**
A: Run multiple identical Prometheus instances scraping the same targets. For global queries and long-term storage, use Thanos or Cortex which federate multiple Prometheus instances.

**Q: What are the retention limitations?**
A: Default local storage retention is 15 days. For longer retention, integrate with remote storage solutions like Thanos, Cortex, VictoriaMetrics, or cloud provider storage.

**Q: Explain metric types in Prometheus.**
A:

- **Counter**: Cumulative metric that only increases (e.g., request count)
- **Gauge**: Metric that can go up or down (e.g., memory usage)
- **Histogram**: Samples observations and counts them in buckets (e.g., request duration)
- **Summary**: Similar to histogram but calculates quantiles on client side

**Q: What is the role of Alertmanager?**
A: Alertmanager handles alerts from Prometheus by deduplicating, grouping, routing to receivers (email, Slack, PagerDuty), and managing silences and inhibitions.

**Q: How do exporters work?**
A: Exporters are separate processes that collect metrics from third-party systems (databases, hardware, applications) and expose them in Prometheus format on an HTTP endpoint for scraping.

**Q: What is the difference between recording rules and alerting rules?**
A: Recording rules precompute frequently used queries and store results as new time series for performance. Alerting rules define conditions that trigger alerts when met.

**Q: How do you monitor Kubernetes with Prometheus?**
A: Use kube-prometheus-stack (includes Prometheus Operator, Grafana, Alertmanager) which automatically discovers and monitors K8s components, nodes, and workloads using ServiceMonitors and PodMonitors.

**Q: What are labels and why are they important?**
A: Labels are key-value pairs attached to metrics that enable multi-dimensional querying and aggregation. They allow filtering and grouping metrics by dimensions like environment, service, or instance.

**Q: Explain scrape_interval and evaluation_interval.**
A:

- **scrape_interval**: How often Prometheus scrapes targets for metrics (default 15s)
- **evaluation_interval**: How often Prometheus evaluates alerting/recording rules (default 15s)
